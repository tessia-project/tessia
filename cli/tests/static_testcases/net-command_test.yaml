description: Additional test for the 'net' command
base_user: admin
tasks_order:
  - base_add
  - net_command
tasks:
  base_add:
    # lab admin to create the lab resources
    - - perm project-add --name='GEO_1 labadmins' --desc='GEO_1 lab admins'
      - Item added successfully.
    - - perm user-add --login=lab_admin@example.com --name='ADMIN_LAB' --title='Title of lab admin'
      - User added successfully.
    - - perm role-grant --login=lab_admin@example.com --name='ADMIN_LAB' --project='GEO_1 labadmins'
      - User role added successfully.
    # create the target project
    - - perm project-add --name='GEO_1 developers' --desc='Developer team'
      - Item added successfully.
    # make sure lab admin also has permissions on this project
    - - perm role-grant --login=lab_admin@example.com --name='ADMIN_LAB' --project='GEO_1 developers'
      - User role added successfully.
    # create target user
    - - perm user-add --login=dev1@example.com --name='Developer 1' --title='Mr. Developer 1'
      - User added successfully.
    - - perm role-grant --login=dev1@example.com --name='USER' --project='GEO_1 developers'
      - User role added successfully.
    # switch to lab admin user
    - - - conf key-gen
        - lab_admin@example.com
        - password
      - Key successfully created and added to client configuration.
  net_command:
    # net help
    - - net -h
      - 'Usage: tess net'
    - - net ip-add  -h
      - 'Usage: tess net ip-add'
    - - net ip-del  -h
      - 'Usage: tess net ip-del'
    - - net ip-edit  -h
      - 'Usage: tess net ip-edit'
    - - net ip-list  -h
      - 'Usage: tess net ip-list'
    - - net subnet-add  -h
      - 'Usage: tess net subnet-add'
    - - net subnet-del  -h
      - 'Usage: tess net subnet-del'
    - - net subnet-edit  -h
      - 'Usage: tess net subnet-edit'
    - - net subnet-list  -h
      - 'Usage: tess net subnet-list'
    - - net zone-add  -h
      - 'Usage: tess net zone-add'
    - - net zone-del  -h
      - 'Usage: tess net zone-del'
    - - net zone-edit  -h
      - 'Usage: tess net zone-edit'
    - - net zone-list  -h
      - 'Usage: tess net zone-list'
    # 'net zone' subcommands
    - - net zone-list
      - No results were found.
    - - net zone-add --name=GEO_1-NE --project='GEO_1 labadmins' --desc='GEO-NE, VLAN 1822'
      - Item added successfully.
    - - net zone-add --name=GEO_2-NE --project='GEO' --desc='GEO-NE, VLAN 1822'
      - "request failed. Server answered: No associated item found with value 'GEO' for field 'Project'"
    - - net zone-add --name=GEO_2-NE --project='GEO_1 labadmins' --desc='GEO-NE, VLAN 1822'
      - Item added successfully.
    - - net zone-edit --name=GEO_2-NE --desc='GEO-NE, VLAN 1823'
      - Item successfully updated.
    - - net zone-edit --name=GEO_2-NE --newname=GEO_2
      - Item successfully updated.
    - - net zone-add --project='GEO_1 labadmins' --desc='GEO-NE, VLAN 1822'
      - Missing option "--name".
    - - net zone-add --name=GEO_3
      - Item added successfully.
      # Empty name
    - - net zone-add --name=
      - 'Invalid value for "--name": value may not be empty'
    - - net zone-add --name=GEO_3 --owner=dev1@example.com
      - 'request failed. Server answered: An item with the provided value'
    - - net zone-del --name=GEO_3
      - Item successfully deleted.
    - - net zone-add --name=GEO_3 --owner=dev1@example.com
      - Item added successfully.
    - - net zone-edit --name=GEO_3 --desc='GEO-NE, VLAN 1823'
      - Item successfully updated.
    - - net zone-edit --name=GEO_3 --owner=dev3@example.com
      - "request failed. Server answered: No associated item found with value 'dev3@example.com' for field 'Owner'"
    - - net zone-list
      - 'Zone name *: GEO_3'
    - - net zone-list --name=GEO_2
      - 'Zone name *: GEO_2'
    - - net zone-list --owner=dev1@example.com
      - 'Zone name *: GEO_3'
    - - net zone-list --project='GEO_1 labadmins'
      - 'Zone name *: GEO_3'
    - - net zone-del --name=GEO_2-NE
      - network zone not found.
    - - net zone-del --name=GEO_2
      - Item successfully deleted.
    - - net zone-del --name=GEO_3
      - Item successfully deleted.
    # 'net subnet' subcommands
    - - net subnet-list
      - 'at least one of --zone or --name must be specified'
    - - net subnet-list --zone=GEO_1-NE
      - No results were found.
    - - net subnet-add --zone=GEO_1-NE --name='GEO 1-NE-1822' --address=192.168.160.0/22
      - Item added successfully.
    - - net subnet-add --zone=GEO_1-NE --name='GEO/1-NE-1822' --address=192.168.160.0/22
      - Invalid value for "--name"
    - - net subnet-add --zone=GEO_1-NE --name='Geo_NE-1822' --address=192.168.160.0/22
      - Item added successfully.
    - - net subnet-add --zone=GEO_1-NE --name='GEO_1-NE-1822' --address=192.168.160.0/22  --gw=192.168.160.1 --dns1=192.168.200.241 --vlan=1822 --project='GEO_1 labadmins' --desc='Shared zone vlan 1822'
      - Item added successfully.
    - - net subnet-list --zone=GEO_1-NE
      - 'Subnet name *: GEO_1-NE-1822'
    - - net subnet-add --name='GEO_1-NE-1820' --address=192.168.160.0/22
      - Missing option "--zone".
    - - net subnet-add  --zone=GEO_1-NE --name='GEO_1-NE-1820'
      - Missing option "--address".
    - - net subnet-add  --zone=GEO_1 --name='GEO_1-NE-1820' --address=192.168.160.0/22
      - "request failed. Server answered: No associated item found with value 'GEO_1' for field 'Network zone'"
    - - net subnet-add --zone=GEO_1-NE --name='GEO_1-NE-1820' --address=192.168.160.0/22  --gw=192.168.160.1 --dns1=192.168.200.241 --vlan=1820 --search='test_example.com' --project='GEO_1 labadmins' --desc='Shared zone vlan 1820'
      - Item added successfully.
    - - net subnet-add --zone=GEO_1-NE --name='GEO_1-NE-1820' --address=192.168.160.0/22 --desc='Shared zone vlan 1823'
      - 'request failed. Server answered: An item with the provided value'
      # Empty name
    - - net subnet-add --zone=GEO_1-NE --name= --address=192.168.160.0/22
      - 'Invalid value for "--name": value may not be empty'
    - - net subnet-edit --zone=GEO_1-NE --name='GEO_1-NE-1820' --search='new_test_example.com' --desc='Shared zone vlan 1823'
      - Item successfully updated.
    - - net subnet-edit --zone=GEO_1 --name='GEO_1-NE-1820' --newname='GEO_1-NE-1823'
      - subnet not found.
    - - net subnet-edit --zone=GEO_1-NE --name='GEO_1-NE' --newname='GEO_1-NE-1823'
      - subnet not found.
    - - net subnet-edit --zone=GEO_1-NE --name='GEO_1-NE-1820'
      - no update criteria provided.
    - - net subnet-edit --zone=GEO_1-NE --name='GEO_1-NE-1820' --newname=''
      - 'Invalid value for "--newname": value may not be empty'
    - - net subnet-edit --zone=GEO_1-NE --name='GEO_1-NE-1820' --newname='GEO_1-NE-1823'
      - Item successfully updated.
    - - net subnet-edit --zone=GEO_1-NE --name='GEO_1-NE-1823' --vlan=VLAN1
      - 'Invalid value for "--vlan": VLAN1 is not a valid integer'
    - - net subnet-edit --zone=GEO_1-NE --name='GEO_1-NE-1823' --owner=dev2@example.com
      - "request failed. Server answered: No associated item found with value 'dev2@example.com' for field 'Owner'"
    - - net subnet-edit --zone=GEO_1-NE --name='GEO_1-NE-1823' --owner=dev1@example.com
      - Item successfully updated.
    - - net subnet-edit --zone=GEO_1-NE --name='GEO_1-NE-1823' --dns2=192.168.200.241
      - Item successfully updated.
    - - net subnet-list --zone=GEO_1-NE
      - 'Subnet name *: GEO_1-NE-1823'
    - - net subnet-list --name='GEO_1-NE-1823'
      - 'Subnet name *: GEO_1-NE-1823'
    - - net subnet-list --zone=GEO_1-NE --address=192.168.160.0/22
      - 'Subnet name *: GEO_1-NE-1822'
    - - net subnet-list --zone=GEO_1-NE --vlan=1820
      - 'Subnet name *: GEO_1-NE-1823'
    - - net subnet-list --zone=GEO_1-NE --owner=dev1@example.com
      - 'Subnet name *: GEO_1-NE-1823'
    - - net subnet-list --zone=GEO_1-NE --project='GEO_1 labadmins'
      - 'Subnet name *: GEO_1-NE-1823'
    - - net subnet-list --name='GEO_1-NE-1822' --vlan=1820
      - No results were found.
    - - net subnet-del --zone=GEO_1-NE
      - Missing option "--name".
    - - net subnet-del --name='GEO_1-NE-1823'
      - Missing option "--zone".
    - - net subnet-del --zone=GEO_1 --name='GEO_1-NE-1823'
      - subnet not found.
    - - net subnet-del --zone=GEO_1-NE --name='GEO_1-NE-1823'
      - Item successfully deleted.
    # 'net ip' subcommands
    - - net ip-list
      - at least one of --subnet or --ip must be specified
    - - net ip-list --subnet='GEO_1-NE-1822'
      - No results were found.
    - - net ip-add --ip=192.168.161.222
      - Missing option "--subnet".
    - - net ip-add --subnet='GEO_1-NE-1822'
      - Missing option "--ip".
    - - net ip-add --subnet='GEO 1-NE-1822' --ip=192.168.161.222
      - Item added successfully.
    - - net ip-add --subnet='GEO/1-NE-1822' --ip=192.168.161.222
      - Invalid value for "--subnet"
    - - net ip-add --subnet='Geo_NE-1822' --ip=192.168.161.222
      - Item added successfully.
    - - net ip-add --subnet='GEO_1-NE' --ip=192.168.161.222
      - "request failed. Server answered: No associated item found with value 'GEO_1-NE' for field 'Part of subnet'"
    - - net ip-add --subnet= --ip=192.168.161.222
      - 'Invalid value for "--subnet": value may not be empty'
    - - net ip-add --subnet='GEO_1-NE-1822' --ip=192.168.161.222
      - Item added successfully.
    - - net ip-add --subnet='GEO_1-NE-1822' --ip=
      - 'Invalid value for "--ip": value may not be empty'
    - - net ip-add --subnet='GEO_1-NE-1822' --ip=192.168.161.222  --project='GEO_1 developers' --desc='For use by lpar 52'
      - 'request failed. Server answered: An item with the provided value'
    - - net ip-add --subnet='GEO_1-NE-1822' --ip=192.168.161.223  --project='GEO_1 developers' --desc='For use by lpar 53' --owner=dev1@example.com
      - Item added successfully.
    - - net ip-edit --subnet='GEO_1-NE-1822' --ip=192.168.161.223  --newip=192.168.161.221
      - Item successfully updated.
    - - net ip-edit --subnet='GEO_1-NE-1822' --ip=192.168.161.223  --desc='For use by lpar 51'
      - ip address not found.
    - - net ip-edit --subnet='GEO_1-NE-1822' --ip=192.168.161.221  --desc='For use by lpar 51'
      - Item successfully updated.
    - - net ip-edit --subnet='GEO_1-NE-1822' --ip=192.168.161.221  --owner=dev1@example.com
      - Item successfully updated.
    - - net ip-edit --subnet='GEO_1-NE-1822' --ip=192.168.161.221  --project='GEO_2 developers'
      - "request failed. Server answered: No associated item found with value 'GEO_2 developers' for field 'Project'"
    - - net ip-edit --subnet='GEO_1-NE-1822' --ip=192.168.161.221  --project='GEO_1 developers'
      - Item successfully updated.
    - - net ip-edit --subnet='GEO_1-NE-1822' --ip=192.168.161.221  --newip=9152.161.221
      - 'Invalid value for "--newip": 9152.161.221 is not a valid ip address'
    - - net ip-list --subnet='GEO_1-NE-1822'
      - 'IP address *: 192.168.161.221'
    - - net ip-list --subnet='GEO_1-NE-1823'
      - No results were found.
    - - net ip-list --ip=192.168.161.222
      - 'IP address *: 192.168.161.222'
    - - net ip-list --ip=192.168.161.223
      - No results were found.
    - - net ip-list --subnet='GEO_1-NE-1822' --project='GEO_1 developers'
      - 'IP address *: 192.168.161.221'
    - - net ip-list --subnet='GEO_1-NE-1822' --owner=dev1@example.com
      - 'IP address *: 192.168.161.221'
    - - net ip-list --subnet='GEO_1-NE-1822' --owner=lab_admin@example.com
      - 'IP address *: 192.168.161.222'
    - - net ip-list --subnet='GEO_1-NE-1822' --owner=dev2@example.com
      - No results were found.
    - - net ip-del --ip=192.168.161.221
      - Missing option "--subnet".
    - - net ip-del --subnet='GEO_1-NE-1822'
      - Missing option "--ip".
    - - net ip-del --subnet= --ip=192.168.161.221
      - 'Invalid value for "--subnet": value may not be empty'
    - - net ip-del --subnet='GEO_1-NE-1823' --ip=192.168.161.221
      - ip address not found.
    - - net ip-del --subnet='GEO_1-NE-1822' --ip=192.168.161.200
      - ip address not found.
    - - net ip-del --subnet='GEO_1-NE-1822' --ip=9152.161.221
      - 'Invalid value for "--ip": 9152.161.221 is not a valid ip address'
    - - net ip-del --net='GEO_1-NE-1822' --ip=192.168.161.221
      - 'no such option: --net'
    - - net ip-del --subnet='GEO_1-NE-1822' --ip=192.168.161.221
      - Item successfully deleted.
